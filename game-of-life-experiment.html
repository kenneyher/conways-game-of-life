<head>
  <title>Game of life DEMO</title>
  <script src="https://cdn.jsdelivr.net/npm/p5@1.3.1/lib/p5.js"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script>
    let theme = 'light';
    function switchTheme(){
      theme = theme == 'light' ? 'dark' : 'light';
      console.log(theme)
    }
    let colors = {dark: {alive: [255, 253, 130], dead: [0, 21, 36,], stroke: [237, 232, 232]}, light: {dead: [237, 232, 232], alive: [136, 173, 110], stroke: [0, 21, 36,]}}
    let universe = [
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,],
    ];
    // function clear(){
    //   fill(237, 232, 232)
    //   square(0, 0, 800);
    // }
    function draw(displaySize, cells){
      const SCALE = displaySize/universe.length
      console.log(SCALE);
      for(let row=0; row<cells.length; row++){
        for(let col=0; col<cells[row].length; col++){
          stroke(colors[theme].stroke)
          if(cells[row][col] == 0){
            fill(colors[theme].dead);
            square(col*SCALE, row*SCALE, SCALE);
          }else {
            fill(colors[theme].alive)
            square(col*SCALE, row*SCALE, SCALE);
          }
        }
      }
    }
    function next(cells) {
      const result = [];
      for (let row = 0; row < cells.length; row++) {
        result.push([])
        for (let col = 0; col < cells[row].length; col++) {
          let a = cells[row - 1]?.[col - 1] || 0;
          let b = cells[row - 1]?.[col] || 0;
          let c = cells[row - 1]?.[col + 1] || 0;
          let d = cells[row]?.[col - 1] || 0;
          let e = cells[row]?.[col + 1] || 0;
          let f = cells[row + 1]?.[col - 1] || 0;
          let g = cells[row + 1]?.[col] || 0;
          let h = cells[row + 1]?.[col + 1] || 0;
          let neighboursAlive = a + b + c + d + e + f + g + h;
          let currentState = cells[row][col]
          let nextState = checkRules(currentState, neighboursAlive)
          result[row].push(nextState)
        }
      }
      return result;
    }

    function checkRules(cellState, neighboursAlive) {
      if (cellState == 0) {
        return neighboursAlive == 3 ? 1 : 0;
      }
      if(neighboursAlive == 2 || neighboursAlive == 3) {
        return 1
      }
      return 0
    }

    async function setup(){
      createCanvas(800, 800);
      background(237, 232, 232);
      fill(237, 232, 232)
      square(0, 0, 800);
      // await new Promise(resolve => setTimeout(resolve, 400));
      var timeout = setTimeout(draw(800, universe),10000);
      var interval = setInterval(() => {draw(800, universe); universe=next(universe)}, 400)
    }
  </script>
  <button id='theme' onclick="javascript:switchTheme()">Switch Theme</button>
</head>
<body>
</body>